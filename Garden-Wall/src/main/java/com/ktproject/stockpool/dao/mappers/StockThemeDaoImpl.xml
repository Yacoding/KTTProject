<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ktproject.stockpool.dao.impl.StockThemeDaoImpl">
	<resultMap id="objectResult" type="com.ktproject.stockpool.model.StockThemeMessageVO"> </resultMap>   
	
	<select id="queryCurrentThemeNews"  resultMap="objectResult" parameterType="hashmap">
		 SELECT
		     THEMENEWS.KEYID,
	         THEMENEWS.LINKURL,
			 SUBSTRING(THEMENEWS.PUBDATE,1,16) AS PUBDATE,
	         THEMENEWS.TITLE
         FROM
	         STOCK_POOL_THEME_NEWS_TABLE THEMENEWS
         WHERE
	         1 = 1
		<if test="limit != null and limit !='' ">
             LIMIT #{start},#{limit}
        </if>
	</select>   
	
	<select id="queryCurrentThemeNewsCount" resultType="int">
		SELECT
		     COUNT(*) AS COUNT
         FROM
	         STOCK_POOL_THEME_NEWS_TABLE THEMENEWS
         WHERE
	         1 = 1
	</select>
	
	   
	<select id="queryCompanyNews" resultMap="objectResult" parameterType="hashmap">
		SELECT
		     COMPANYNEWS.KEYID,
	         COMPANYNEWS.LINKURL,
			 SUBSTRING(COMPANYNEWS.PUBDATE,1,16) AS PUBDATE,
			 SUBSTRING(COMPANYNEWS.TITLE,1,35) AS TITLE
         FROM
	         STOCK_POOL_COMPANY_NEWS_TABLE  COMPANYNEWS
         WHERE
           1=1 
		 ORDER  BY  COMPANYNEWS.PUBDATE DESC 
		<if test="limit != null and limit !='' ">
             LIMIT #{start},#{limit}
        </if>
	</select>
	
	<select id="queryCompanyNewsCount" resultType="int">
		 SELECT  COUNT(*) AS COUNT  FROM STOCK_POOL_COMPANY_NEWS_TABLE  COMPANYNEWS
	</select>
		
</mapper>